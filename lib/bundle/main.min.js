!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).caretPos={})}(this,function(t){"use strict";function d(e,t){var o,n,r,i=document.createElement("div");return o=t,n={position:"absolute",left:-9999,top:0,zIndex:-2e3},"TEXTAREA"===e.tagName&&a.push("width"),a.forEach(function(t){n[t]=getComputedStyle(e)[t]}),r=n,Object.keys(r).forEach(function(t){i.style[t]=r[t]}),i.innerHTML=o,e.parentNode.insertBefore(i,e.nextSibling),{rect:function(){var t=i.ownerDocument.getElementById("caret-position-marker"),e={left:t.offsetLeft,top:t.offsetTop,height:t.offsetHeight};return i.parentNode.removeChild(i),e}}}var a=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"];function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){var e=0<arguments.length&&void 0!==t?t:{},o=e.customPos,n=e.iframe,r=e.noShadowCaret;return n?{iframe:n,window:n.contentWindow,document:n.contentDocument||n.contentWindow.document,noShadowCaret:r,customPos:o}:{window:window,document:document,noShadowCaret:r,customPos:o}}function s(t,e){var o=e&&e.window||window,n=e&&e.document||document,r=t.getBoundingClientRect(),i=n.documentElement,a=o.pageXOffset||i.scrollLeft,f=o.pageYOffset||i.scrollTop;return{top:r.top+f,left:r.left+a}}function l(t){return"object"===e(t)&&null!==t}function n(f,l){function c(){return f.selectionStart}var i=function(t){function e(t){return t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>")}!l.customPos&&0!==l.customPos||(t=l.customPos);var o=void 0===t?c():t,n=f.value.slice(0,o),r=f.value.slice(o),i='<span style="position: relative; display: inline;">'.concat(e(n),"</span>");i+='<span id="caret-position-marker" style="position: relative; display: inline;">|</span>',i+='<span style="position: relative; display: inline;">'.concat(e(r),"</span>");var a=d(f,i).rect();return a.pos=c(),a};return{getPos:c,setPos:function(t){return f.setSelectionRange(t,t),f},getOffset:function(t){var e=s(f),o=i(t),n=e.top+o.top+l.document.body.scrollTop,r=e.left+o.left+l.document.body.scrollLeft;return"TEXTAREA"===f.tagName&&(n-=f.scrollTop||0,r-=f.scrollLeft||0),{top:n,left:r,height:o.height}},getPosition:i}}function r(d,s){function i(){var t=u(),e={height:0,left:0,right:0};if(!t)return e;var o=s.customPos||0===s.customPos;if(0<t.endOffset-1&&t.endContainer!==d||o){var n=t.cloneRange(),r=o?s.customPos:t.endOffset;n.setStart(t.endContainer,r-1<0?0:r-1),n.setEnd(t.endContainer,r);var i=n.getBoundingClientRect();e={height:i.height,left:i.left+i.width,top:i.top},n.detach()}if((!e||e&&0===e.height)&&!s.noShadowCaret){var a=t.cloneRange(),f=s.document.createTextNode("|");a.insertNode(f),a.selectNode(f);var l=a.getBoundingClientRect();e={height:l.height,left:l.left,top:l.top},f.parentNode.removeChild(f),a.detach()}if(e){var c=s.document.documentElement;e.top+=s.window.pageYOffset-(c.clientTop||0),e.left+=s.window.pageXOffset-(c.clientLeft||0)}return e}var u=function(){if(s.window.getSelection){var t=s.window.getSelection();return 0<t.rangeCount?t.getRangeAt(0):null}},a=function(){var t=u(),e=t.cloneRange();e.selectNodeContents(d),e.setEnd(t.endContainer,t.endOffset);var o=e.toString().length;return e.detach(),o};return{getPos:a,setPos:function(a){var f=s.window.getSelection();if(f){var l=0,c=!1;!function t(e,o){for(var n=0;n<o.childNodes.length;n++){var r=o.childNodes[n];if(c)break;if(3===r.nodeType){if(l+r.length>=e){c=!0;var i=s.document.createRange();i.setStart(r,e-l),f.removeAllRanges(),f.addRange(i);break}l+=r.length}else t(a,r)}}(a,d)}return d},getPosition:function(){var t=i(),e=a(),o=d.getBoundingClientRect(),n=o.top+s.document.body.scrollTop,r=o.left+s.document.body.scrollLeft;return t.left-=r,t.top-=n,t.pos=e,t},getOffset:i,getRange:u}}function c(t,e){return(((o=t).contentEditable?"true"===o.contentEditable:"true"===o.getAttribute("contenteditable"))?r:n)(t,e);var o}t.getOffset=s,t.offset=function(t,e,o){var n=2<arguments.length&&void 0!==o?o:{};l(e)&&(n=e,e=null);var r=f(n);return c(t,r).getOffset(e)},t.position=function(t,e,o){var n=2<arguments.length&&void 0!==o?o:{};l(e)&&(n=e,e=null);var r=f(n),i=c(t,r);return e||0===e?i.setPos(e):i.getPosition()},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=main.min.js.map
